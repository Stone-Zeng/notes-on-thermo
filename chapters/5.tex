%% Copyright (C) 2016--2018 by Xiangdong Zeng <pssysrq@163.com>
%%
%% -* Notes on Thermodynamics and Statistical Physics *-
%%
%% This file may be distributed and/or modified under the
%% Creative Commons Attribution Share Alike 4.0 license.

\chapter{统计物理学基本概念} \label{chap:statistical-physics-basis}

\section{微观态的经典及量子描述}

\subsection{单粒子的经典描述}

微观态的经典描述以经典力学为基础，通常采用广义坐标与广义动量的形式。

对于一个有 $r$ 个自由度的系统，需要用 $2r$ 个变量来描述其运动状态，即 $r$ 个广义坐标和 $r$ 个广义动
量：
\begin{equation}
  (q_i, \, p_i) \qq{where} i = 1, \, 2, \, \cdots, r.
\end{equation}
系统的 Hamilton 量为
\begin{equation}
  H = H (q_1, \, q_2, \, \cdots, q_r; \, p_1, \, p_2, \, \cdots, p_r; \, t),
\end{equation}
正则方程为
\begin{braced}
  \dot{q_i} &= \pdv{H}{p_i}, \\
  \dot{p_i} &= -\pdv{H}{q_i}.
\end{braced}

坐标和动量 $(q_1, \, q_2, \, \cdots, q_r; \, p_1, \, p_2, \, \cdots, p_r)$ 张成一个 $2r$ 维空间，称
为 \kwd{μ 空间}（或\kwd{子相空间}），每一组坐标和动量描述的点称为\kwd{代表点}。

\begin{example}[自由粒子]
  对于一个 $r=3$ 的自由粒子，有
  \begin{braced}
    & p_x = m \dot{x}, \\
    & p_y = m \dot{y}, \\
    & p_z = m \dot{z}.
  \end{braced}
  其 μ 空间由 $(x, \, y, \, z; \, p_x, \, p_y, \, p_z)$ 张成。Hamilton 量为
  \begin{equation}
    H = \frac{1}{2m} \qty\big(p_x^2+p_y^2+p_z^2).
  \end{equation}
% TODO: (2016-05-04) 示意图
\end{example}

\begin{example}[一维谐振子]
  质量为 $m$ 的物体受力 $F=-Ax$ 的作用做简谐运动，其角频率等于
  \begin{equation}
    \omega = \sqrt{\frac{A}{m}},
  \end{equation}
  而 Hamilton 量为
  \begin{equation}
    H = \frac{p^2}{2m} + \frac{A}{2} x^2
      = \frac{p^2}{2m} + \frac{1}{2} m \omega^2 x^2.
  \end{equation}

  若总能量一定，即 $H=E$，则
  \begin{equation}
    \frac{p^2}{2mE} + \frac{x^2}{2E / m \omega^2} = 1,
  \end{equation}
  这在 μ 空间中表示一个椭圆（见图~\ref{fig:harmonic-oscillator-mu-space}），其面积为
  \begin{equation} \label{eq:ellipse-of-harmonic-oscillator-mu-space}
    S_\text{ellipse} = \pp ab
      = \pp \cdot \sqrt{\frac{2E}{m \omega^2}} \cdot \sqrt{2mE}
      = \frac{2 \pp E}{\omega}.
  \end{equation}
\end{example}

\begin{figure}[ht]
  \centering
  \FIGPLACEHOLDER
  \caption{μ 空间中的一维谐振子}
  \label{fig:harmonic-oscillator-mu-space}
\end{figure}

\begin{example}[转子]
  如图~\ref{fig:rotator} 所示，质量为 $m$ 的物体被轻杆连接在 $O$ 点处，并可绕该点运动。其 Hamilton
  量为
  \begin{equation} \label{eq:rotator-hamiltonian}
    H = \frac{m}{2} \qty\big(\dot{x}^2+\dot{y}^2+\dot{z}^2).
  \end{equation}
  取球坐标系，则有
  \begin{braced}
    x &= r \sin{\theta}\cos{\phi}, \\
    y &= r \sin{\theta}\sin{\phi}, \\
    z &= r \cos{\theta}.
  \end{braced}
  求导，得
  \begin{braced}
    \dot{x} &= \dot{r}\sin{\theta}\cos{\phi}
             + r\dot{\theta}\cos{\theta}\cos{\phi}
             - r\dot{\phi}\sin{\theta}\sin{\phi}, \\
    \dot{y} &= \dot{r}\sin{\theta}\sin{\phi}
             + r\dot{\theta}\cos{\theta}\sin{\phi}
             + r\dot{\phi}\sin{\theta}\cos{\phi}, \\
    \dot{z} &= \dot{r}\cos{\theta} - r\dot{\theta}\sin{\theta}.
  \end{braced}
  计算可知
  \begin{equation}
    \dot{x}^2 + \dot{y}^2 + \dot{z}^2
    = \dot{r}^2 + (r\dot{\theta})^2 + (r\dot{\phi})^2 \sin^2\theta.
  \end{equation}
  代入 \eqref{eq:rotator-hamiltonian}~式，得
  \begin{align}
    H &= \frac{m}{2} \qty\big(\dot{r}^2 + r^2 \dot{\theta}^2
                              + r^2 \dot{\phi}^2 \sin^2\theta).
  \end{align}
  由于物体已被轻杆连接在了 $O$ 点，因而 $r$ 不变、$\dot{r}=0$。

  引入\kwd{共轭动量}
  \begin{braced}
    p_\theta &= m r^2 \dot{\theta}, \\
    p_\phi   &= m r^2 \dot{\phi} \sin^2\theta,
  \end{braced}
  则系统的 Hamilton 量可写为
  \begin{equation}
    H = \frac{1}{2I} \qty(p_\theta^2 + \frac{1}{\sin^2\theta} p_\phi^2),
  \end{equation}
  其中的 $I = mr^2$ 是物体关于 $O$ 点的\kwd{转动惯量}。

  在本例中，μ 空间由广义坐标和广义动量
  $(\theta, \, \phi; \, p_\theta, \, p_\phi)$ 张成，它是四维的。
\end{example}

\begin{figure}[ht]
  \centering
  \FIGPLACEHOLDER
  \caption{转子的示意图}
  \label{fig:rotator}
\end{figure}

\subsection{单粒子的量子描述}

微观态的量子描述以量子力学为基础。粒子的动量 $\V{p}$、能量 $E$ 满足 \kwd{de Broglie关系}：
\begin{braced}
  \V{p} &= \hbar\V{k}, \\
  E     &= \hbar\omega,
\end{braced}
其中的 $\hbar$ 称为\kwd{（约化）Planck 常数}，其值为
\begin{equation}
  \hbar = \frac{h}{2\pp} = \SI{1.0545718e-34}{\joule\second}.
\end{equation}
式中的 $h$ 也称 Planck 常数。

De Broglie 关系说明微观粒子具有\kwd{波粒二象性}。这就引出了另一个重要结果——\kwd{不确定关系}：
\begin{equation}
  \incr{p} \incr{q} \gtrsim h.
  \footnote{更精确的表述为 $\incr{p} \incr{q} \geqslant \hbar / 2 $。}
\end{equation}
可见，在 $\incr{p}\to 0$ 时，必有 $\incr{q}\to\infty$。这说明粒子的动量和坐标不可能被同时精确测量，
因而其运动也就无法用经典的轨道概念来描述，必须改用\kwd{波函数}。

粒子波函数 $\Psi$ 满足的方程即 \kwd{Schrödinger 方程}：
\begin{equation}
  \ii \pdv{t} \Psi = \hat{H} \Psi,
\end{equation}
式中的 $\hat{H}$ 是 Hamilton 算符。在定态情况（即将时间变量分离后），Schrödinger 方程化为
\begin{equation}
  \hat{H} \psi = E \psi.
\end{equation}

\begin{example}[箱中的自由粒子]
  设粒子在边长为 $L$ 的立方体容器内运动，则其量子态（即波函数）有平面波的形式：
  \begin{equation}
    \Psi_{n_1, \, n_2, \, n_3} (\V{r})
    \sim \ee^{\ii\V{p}\cdot\V{r} / \hbar} \qc
    n_i = \pm 1, \, \pm 2, \, \pm 3, \, \cdots
  \end{equation}
  求解 Schrödinger 方程，可以发现动量与能量的本征值都是量子化的：
  \begin{braced}
    \V{p} &= p_x\V{i} + p_y\V{j} + p_z\V{k}
           = \frac{2\pp\hbar}{L} n_1\V{i} + n_2\V{j} + n_3\V{k}, \\
        E &= \frac{1}{2m} \qty\big(p_x^2 + p_y^2 + p_z^2)
           = \frac{2\pp^2 \hbar^2}{mL^2} \qty\big(n_1^2 + n_2^2 + n_3^2).
  \end{braced}
  量子化的能量也成为\kwd{能级}。对于能级
  \begin{equation}
    E = \frac{2\pp^2\hbar^2}{mL^2},
  \end{equation}
  它对应6种量子态：
  \begin{equation}
    (\pm 1, \, 0, \, 0) \qc (0, \, \pm 1, \, 0) \qc (0, \, 0, \, \pm 1).
  \end{equation}
  这种现象称为能级\kwd{简并}。同一能级对应量子态的数目称为\kwd{简并度}。显然，这里的简并度为 6。而能
  量更高的一个能级
  \begin{equation}
    E = \frac{2\pp^2\hbar^2}{mL^2} \times 3
      = \frac{2\pp^2\hbar^2}{mL^2} \times (1+1+1)
  \end{equation}
  则对应 $2^3=8$ 个量子态，它的简并度为 8。
\end{example}

\begin{example}[一维谐振子]
  频率为 $\nu$ 的谐振子，其能量为
  \begin{equation}
    E_n = \qty(n+\frac{1}{2}) \, h\nu \qc n = 0, \, 1, \, 2, \, \cdots
  \end{equation}
  可见该系统的简并度 $g=1$。

  根据式~\eqref{eq:ellipse-of-harmonic-oscillator-mu-space}，μ 空间中的椭圆面积为
  \begin{equation}
    S_n = \frac{2\pp E_n}{\omega} =\frac{E_n}{\nu} = \qty(n+\frac{1}{2}) \, h.
  \end{equation}
  因此两个相轨道之间的面积为 $h$，它对应一个量子态。
\end{example}

\begin{example}[转子]
% TODO: (2016-06-24) 角动量量子化
\end{example}

\subsection{多粒子系统}

对于 $N$ 个粒子组成的系统，设每个粒子的自由度为 $r$，则每个粒子可用 $2r$ 个变量
$(q_1, \, q_2, \, \cdots, q_r; \, \allowbreak p_1, \, p_2, \, \cdots, p_r)$ 来描述。此时，系统的总自
由度
\begin{equation}
  f = Nr,
\end{equation}
因而系统的运动需要用 $2f$ 个变量 $(q_1, \, q_2, \, \cdots, q_f; \, p_1, \, p_2, \, \cdots, p_f)$ 来
刻画。这些变量张成了一个 $2f$ 维空间，称为\kwd{Γ 空间}，也叫\kwd{相空间}。Γ 空间中的一个点就表示系统
的一个微观状态，状态运动的微小范围可用体积元表示：
\begin{equation}
  \incr{\Omega} = \incr{q_1} \cdots \incr{q_f} \incr{p_1} \cdots \incr{p_f}.
\end{equation}
根据不确定关系，取 $\incr{p} \incr{q} \simeq h$，则有
\begin{equation}
  \incr{\Omega} = \incr{q_1} \incr{p_1} \cdots \incr{q_f} \incr{p_f} \simeq h^f.
\end{equation}
这是多粒子系统的相格大小。

统计物理研究的系统往往由大量\kwd{全同粒子}组成。全同粒子是指内禀性质，如质量、电荷、自旋等均完全相同
的粒子。根据量子力学，全同粒子具有不可分辨性。换句话说，全同粒子的交换不引起新的量子态。

设系统的波函数为 $\Psi$。引入\kwd{交换算符} $\hat{P}$，根据全同粒子的不可分辨性，可有
\begin{equation}
  \abs{\hat{P}\Psi}^2 = \abs{\Psi}^2 \implies \hat{P}\Psi = \pm\Psi.
\end{equation}

波函数交换对称，即 $\hat{P}\Psi=+\Psi$ 的粒子，称为 \kwd{Bose 子}。它们遵循
\kwd{Bose--Einstein 统计}，并且自旋为整数。光子、π 介子、胶子以及 Higgs 粒子等都是 Bose 子。单一量子
态上可占据任意数目的 Bose 子。

波函数交换反对称，即 $\hat{P}\Psi=-\Psi$ 的粒子，称为 \kwd{Fermi 子}。它们遵循
\kwd{Fermi--Dirac 统计}，自旋为半整数。电子、质子、中子以及夸克等都是 Fermi 子。全同 Fermi 子组成的
系统满足 \kwd{Pauli 不相容原理}，即单一量子态上只可占据 0 个或 1 个 Fermi 子。

就基本粒子而言，Bose 子传递相互作用，而 Fermi 子组成物质。对于复合粒子，如果含有偶数个 Fermi 子，则
为 Bose 子；如果含有奇数个 Fermi 子，则为 Fermi 子。例如氦的同位素 \ce{^4He}，它包含两个质子、两个中
子和两个电子，为 Bose 子；而 \ce{^3He} 则包含两个质子、一个中子和两个电子，为 Fermi 子。

对于多粒子系统，如果各粒子的波函数分别局限在空间不同范围内，彼此交叠很少，则称为\kwd{定域子系}。此
时，交换两个粒子的波函数（对应于量子态），可以看出系统的微观状态发生了变化（见图~%
\ref{fig:localized-sub-system}），因而即使是全同粒子，在定域子系中也可分辨。定域子系遵循
\kwd{Boltzmann 统计}。

\begin{figure}[ht]
  \centering
  \FIGPLACEHOLDER
  \caption{定域子系}
  \label{fig:localized-sub-system}
\end{figure}

下面我们举例说明单粒子量子态与多体量子态之间的关系。设系统由两个粒子组成，每个粒子可以处在四个量子态
下。不同情况下，粒子的所有分布方式列于表~\ref{tab:two-particles-distribution}。由此可知，对于定域子
系、非定域 Bose 子和非定域 Fermi 子，系统分别有 16 个、10 个和 6 个量子态。

\begin{table}[ht]
  \def\B{{\Large\symbol{"25CB}}}
  \let\TC=\textcircled
  \newcommand\STATE[4]{%
    \CJKunderline{\makebox[2em][c]{#1}}\kern1em%
    \CJKunderline{\makebox[2em][c]{#2}}\kern1em%
    \CJKunderline{\makebox[2em][c]{#3}}\kern1em%
    \CJKunderline{\makebox[2em][c]{#4}}}
  \newcommand\TITLE[1]{\makebox[11em][c]{#1}}
  \centering
  \caption{两个粒子在四个量子态中的分布情况}
  \label{tab:two-particles-distribution}
  \begin{tabular}{c|c|c}
    \toprule
      \multicolumn{3}{c}{%
        \begin{tabular}{@{}ccc@{}}
          \TITLE{定域子系} & \TITLE{非定域 Bose 子} & \TITLE{非定域 Fermi 子}
        \end{tabular}} \\
    \midrule
      \STATE{\TC1\TC2}{}{}{} & \STATE{\B\B}{}{}{} & \\
      \STATE{}{\TC1\TC2}{}{} & \STATE{}{\B\B}{}{} & \\
      \STATE{}{}{\TC1\TC2}{} & \STATE{}{}{\B\B}{} & \\
      \STATE{}{}{}{\TC1\TC2} & \STATE{}{}{}{\B\B} & \\
      \STATE{\TC1}{\TC2}{}{} & \STATE{\B}{\B}{}{} & \STATE{\B}{\B}{}{} \\
      \STATE{\TC2}{\TC1}{}{} &                    &                    \\
      \STATE{\TC1}{\TC2}{}{} & \STATE{\B}{}{\B}{} & \STATE{\B}{}{\B}{} \\
      \STATE{\TC2}{}{\TC1}{} &                    &                    \\
      \STATE{\TC1}{}{\TC2}{} & \STATE{\B}{}{}{\B} & \STATE{\B}{}{}{\B} \\
      \STATE{\TC2}{}{}{\TC1} &                    &                    \\
      \STATE{}{\TC1}{\TC2}{} & \STATE{}{\B}{\B}{} & \STATE{}{\B}{\B}{} \\
      \STATE{}{\TC2}{\TC1}{} &                    &                    \\
      \STATE{}{\TC1}{}{\TC2} & \STATE{}{\B}{}{\B} & \STATE{}{\B}{}{\B} \\
      \STATE{}{\TC2}{}{\TC1} &                    &                    \\
      \STATE{}{}{\TC1}{\TC2} & \STATE{}{}{\B}{\B} & \STATE{}{}{\B}{\B} \\
      \STATE{}{}{\TC2}{\TC1} &                    &                    \\
    \bottomrule
  \end{tabular}
\end{table}

至于一般情况，我们将在 \ref{sec:distribution-and-microstate}~节中讨论。

\section{宏观量；等概率原理}

\subsection{宏观量的统计性质}

统计物理学的基本观点是：宏观量是微观量的统计平均。宏观观测有如下特点：

\begin{itemize}
  \item 空间尺度上，宏观小、微观大；
  \item 时间尺度上，宏观短、微观长。
\end{itemize}

由此我们可以知道，任意宏观态都对应着非常多的微观态。

\subsection{统计规律性}

就微观层面而言，粒子的运动遵循\kwd{力学规律}。无论是经典力学中的 Newton 方程，还是量子力学中的
Schrödinger 方程，都具有\kwd{时间反演}对称性，因而是可逆的。但在宏观层面，考虑到热力学第二定律，热现
象过程具有不可逆性，即时间有确定方向。这是\kwd{统计规律}的体现。

力学规律是确定性的，一旦运动方程确定，系统在任意时刻的状态就可以确定；而统计规律则具有不确定性，在一
定宏观条件下，系统总是以一定概率处于某一微观状态。

造成统计规律的原因主要有下面两点：

\begin{itemize}
  \item 宏观态对应着数量极其巨大的微观态，这些微观态不可能由宏观状态唯一决定；
  \item 系统与环境之间总是不可避免地存在相互作用，而且这些相互作用又有一定的随机性。
\end{itemize}

\subsection{等概率原理}

\kwd{等概率原理}（equal a priori probability postulate）最早由 Boltzmann 提出，它可以表述为：对于平
衡态下的孤立系，各微观态出现的概率相同。这是统计物理学的基本假设。

\section{分布和微观状态} \label{sec:distribution-and-microstate}

% TODO: (2018-01-08) 交叉引用
在本节以及第%\ref{}
章中，我们均要求粒子之间相互作用可以忽略。因而总能量等于各粒子的能量之和。这样
的系统称为\kwd{近独立粒子系统}。

设粒子的能级为 $\varepsilon_1, \, \varepsilon_2, \, \cdots, \, \varepsilon_l, \, \cdots$，各能级的简
并度为 $\omega_1, \, \omega_2, \, \cdots, \, \omega_l, \, \cdots$。我们把每个能级上占据的粒子数
$a_1, \, a_2, \, \cdots, \, a_l, \, \cdots$ 称为一个\kwd{（微观）分布}，简记为 $\qty{a_l}$。对于平衡
态下的孤立系，能量 $E$、体积 $V$、粒子数 $N$ 都是给定的。因此分布 $\qty{a_l}$ 需要满足
\begin{braced}[\label{eq:constraint-condition-of-dist}]
  & \sum_l a_l = N,               \label{eq:constraint-condition-N-of-dist} \\
  & \sum_l \varepsilon_l a_l = E. \label{eq:constraint-condition-E-of-dist}
\end{braced}

注意分布与量子态是不同的概念。
% TODO: (2018-01-08) 不同之处？

\subsection{Boltzmann 体系}

Boltzmann 体系由定域子系组成。在能级 $\varepsilon_l$ 上，有 $\omega_l$ 个量子态（简并度），并占据着
$a_l$ 个粒子。粒子所处的量子态互不影响，且粒子可以编号。根据乘法原理，所有分布情况数等于每个粒子的可
能量子态数目之积，即 ${\omega_l}^{a_l}$。对于整个体系而言，需将所有能级上的量子态数目乘起来，即
$\prod_l {\omega_l}^{a_l}$。

分布 $\qty{a_l}$ 仅仅指定了粒子的数目，而没有指定具体是哪些粒子，所以还要考虑不同能级之间粒子数的交
换。交换 $N$ 个粒子的所有可能方式（全排列）共有 $\Pnum{N}{N}=N!$ 种。而单个能级上粒子的交换并不会造
成任何改变
\footnote{在能级 $\varepsilon_l$ 上，粒子交换带来微观状态的变化，已经计算在了
  ${\omega_l}^{a_l}$ 中。}，
因此需要除去所有能级上粒子的交换数 $\prod_l a_l!$。

综上，分布 $\qty{a_l}$ 对应的总量子态数为
\begin{equation} \label{eq:number-of-states-in-boltzmann-dist}
  \Omega_\text{MB}(\qty{a_l}) = \frac{N!}{\prod_l a_l!} \prod_l {\omega_l}^{a_l}.
\end{equation}
下标“$\text{MB}$”表示粒子服从 Maxwell--Boltzmann 统计。

\subsection{Bose--Einstein 体系} \label{subsec:bose-einstein-system}

Bose--Einstein 体系由 Bose 子组成。相比定域子系，Bose 子具有不可分辨性，而且在每个量子态上可占据任意
数量。因而 $a_l$ 个 Bose 子在 $\omega_l$ 个量子态上的分布，就相当于 $a_l$ 个相同的小球放在
$\omega_l$ 个不同的盒子中。考虑使用“插空法”，即先将 $a_l$ 个小球和 $\omega_l-1$ 个挡板排列（此时已经
将球分成了 $\omega_l$ 份），再从中选出 $a_l$ 个位置放小球。可见，共有
\begin{equation}
  \Cnum{a_l+\omega_l-1}{a_l} = \frac{\qty(a_l+\omega_l-1)!}{a! \, \qty(\omega_l-1)!}
\end{equation}
种情况。

由于不可分辨性，这里不需要考虑不同能级上粒子的交换。所以总量子态数为
\begin{equation} \label{eq:number-of-states-in-bose-dist}
  \Omega_\text{BE}(\qty{a_l}) = \prod_l \frac{\qty(a_l+\omega_l-1)!}{a! \, \qty(\omega_l-1)!}.
\end{equation}
下标“$\text{BE}$”表示粒子服从 Bose--Einstein 统计。

\subsection{Fermi--Dirac 体系}

Fermi--Dirac 体系由 Fermi 子组成。根据 Pauli 不相容原理，每个量子态上最多只能占据一个 Fermi 子，这相
当于从 $\omega_l$ 个量子态中选出 $a_l$ 个态来让粒子分布。因此共有
\begin{equation}
  \Cnum{\omega_l}{a_l} = \frac{\omega_l!}{a_l! \, \qty(\omega_l-a_l)!}
\end{equation}
种情况。显然，此时要求 $k \leqslant n$。

与 Bose--Einstein 体系相同，这里同样不需要考虑粒子的交换。总量子态数为
\begin{equation} \label{eq:number-of-states-in-fermi-dist}
  \Omega_\text{FD}(\qty{a_l}) = \prod_l \frac{\omega_l!}{a_l! \, \qty(\omega_l-a_l)!}.
\end{equation}
下标“$\text{FD}$”表示粒子服从 Fermi--Dirac 统计。

\subsection{非简并条件（I）} \label{subsec:non-degenerate-condition-i}

当每个量子态上占据的粒子非常“稀薄”，即
\begin{equation} \label{eq:non-degenerate-condition}
  \frac{a_l}{\omega_l} \ll 1,
\end{equation}
且 $\omega_l$ 很大时，我们有
\begin{braced}[\label{eq:bose-and-fermi-dist-non-degenerate}]
  \Omega_\text{BE}(\qty{a_l}) &= \prod_l \frac{\qty(a_l+\omega_l-1)!}{a! \, \qty(\omega_l-1)!}
  = \prod_l \frac{\qty(\omega_l+a_l-1) \qty(\omega+a_l-2) \cdots \omega_l}{a_l!}
  \approx \prod_l \frac{{\omega_l}^{a_l}}{a_l!}
  = \frac{\Omega_\text{MB}(\qty{a_l})}{N!}, \\
  \Omega_\text{FD}(\qty{a_l}) &= \prod_l \frac{\omega_l!}{a_l! \, \qty(\omega_l-a_l)!}
  = \prod_l \frac{\omega_l \qty(\omega_l-1) \cdots \qty(\omega-a_l+1)}{a_l!}
  \approx \prod_l \frac{{\omega_l}^{a_l}}{a_l!}
  = \frac{\Omega_\text{MB}(\qty{a_l})}{N!}.
\end{braced}
这说明在\kwd{非简并条件}式~\eqref{eq:non-degenerate-condition} 下，Bose--Einstein 分布、Fermi--%
Dirac 分布与 Maxwell--Boltzmann 分布的差别将逐渐消失。

注意式~\eqref{eq:bose-and-fermi-dist-non-degenerate} 最后的结果中有一个 $1/N!$，这反映了粒子的全同性
要求。

\section{Maxwell--Boltzmann 分布}

根据等概率原理，平衡态下各微观态出现的概率相同。因此，对应微观态数目最多的分布，出现的概率最大，称
为\kwd{最概然分布}。

对于 Boltzmann 体系，即定域子系组成的系统，分布 $\qty{a_l}$ 对应的微观态（量子态）数目
$\Omega_\text{MB}(\qty{a_l})$ 由式~\eqref{eq:number-of-states-in-boltzmann-dist} 给出。现在我们做要
做的，就是找到使 $\Omega_\text{MB}(\qty{a_l})$ 取极大值的分布 $\qty{a_l}$。但需注意，系统的粒子数
$N$、能量 $E$ 还需满足如下关系：
\begin{braced*}
  & \sum_l a_l = N,               \tag*{\eqref{eq:constraint-condition-N-of-dist}} \\
  & \sum_l \varepsilon_l a_l = E. \tag*{\eqref{eq:constraint-condition-E-of-dist}}
\end{braced*}
因而这是一个带约束条件的极值问题，数学上的标准求解手段是 \kwd{Lagrange 乘子法}。下面给出具体的操作。

为处理方便，我们把求 $\Omega$
\footnote{本节以下部分将略去下标“MB”。}
的极大值改为求 $\ln\Omega$ 的极大值。利用
\kwd{Stirling 公式}
\begin{equation}
  n!     \approx \sqrt{2\pp n} \qty(\frac{n}{\ee})^n \qc
  \ln n! \approx n\,\qty(\ln n-1) + \frac{1}{2}\ln(2\pp n)
         \approx n\,\qty(\ln n-1) \qc
  n \gg 1,
\end{equation}
可有
\begin{align}
  \ln\Omega
  &= \ln(\frac{N!}{\prod_l a_l!} \prod_l {\omega_l}^{a_l})
   = \ln N! - \sum_l\ln a_l! + \sum_l a_l \ln\omega_l \notag \\
  &\approx N\,\qty(\ln N-1) - \sum_l a_l\,\qty(\ln a_l-1) + \sum_l a_l\ln\omega_l \notag
  \intertext{利用约束条件 $N=\sum_l a_l$：}
  &= N\ln N - \sum_l a_l\ln a_l + \sum_l a_l\ln\omega_l \notag \\
  &= N\ln N - \sum_l a_l\ln\frac{\omega_l}{a_l}.
\end{align}

极值点要求满足 $\var{\ln\Omega}=0$
\footnote{这里我们用了变分记号“$\var{}$”，用以强调 $\var{a_l}$ 并非真实变动。具体计算上，与普通微分
相同。}：
\begin{equation} \label{eq:delta-Omega=0}
  \var{\ln\Omega}
  = \var(N\ln N) - \sum_l \qty(\var{a_l}\ln\frac{\omega_l}{a_l}
                               -a_l\cdot\frac{1}{a_l}\cdot\var{a_l})
  = -\sum_l \qty(\ln\frac{a_l}{\omega_l}+1) \var{a_l} = 0.
\end{equation}
而根据约束条件则有
\begin{equation}
  \var{N} = \sum_l \var{a_l} = 0 \qc
  \var{E} = \sum_l \varepsilon_l \var{a_l} = 0.
\end{equation}
两式分别乘上系数 $\alpha-1$ 和 $\beta$（称为 \kwd{Lagrange 不定乘子}），并从式~%
\eqref{eq:delta-Omega=0} 中减去，可得：
\begin{equation}
  \var{\ln\Omega} - \qty(\alpha-1)\var{N} - \beta\var{E}
  = -\sum_l\qty(\ln\frac{a_l}{\omega_l}+\alpha+\beta\varepsilon_l) \var{a_l} = 0.
\end{equation}
根据 Lagrange 乘子法，令 $\var{a_l}$ 的系数为零，有
\begin{equation}
  \ln\frac{a_l}{\omega_l}+\alpha+\beta\varepsilon_l = 0 \qc l = 1, \, 2, \, \cdots
\end{equation}
这样就得到了最概然分布
\begin{equation} \label{eq:maxwell-boltzmann-dist}
  \tilde{a_l} = \omega_l \, \ee^{-\alpha-\beta\varepsilon_l}.
\end{equation}
式中的 Lagrange 不定乘子 $\alpha$ 与 $\beta$，可根据约束关系式~%
\eqref{eq:constraint-condition-of-dist} 确定，我们将在稍后下一章中计算。
% TODO: (2018-01-07) 下一章的计算，交叉引用

计算二阶变分：
\begin{align}
  \var[2]{\ln\Omega}
  &= -\sum_l \qty[  \qty(\frac{1}{a_l}\cdot\var{a_l})\var{a_l}
                  + \qty(\ln\frac{a_l}{\omega_l}+1) \var[2]{a_l}] \notag
  \intertext{忽略 $a_l$ 的二阶变分，得}
  &= -\sum_l \frac{\qty(\var{a_l})^2}{a_l} < 0.
\end{align}
$a_l>0$，所以该式恒小于零。这就验证了最概然分布 $\qty{\tilde{a_l}}$ 的确对应 $\ln\Omega$ 的极大值。
式~\eqref{eq:maxwell-boltzmann-dist} 给出的结果即为 \kwd{Maxwell--Boltzmann 分布}。

设粒子数分布相对最概然分布 $\qty{\tilde{a_l}}$ 有一微小偏离 $\var{a_l}$，并使得量子态数目变化了
$\var{\Omega}$。利用 Taylor 展开，可有
\begin{align}
  \ln(\Omega+\incr{\Omega})
  = \ln\Omega\qty(\qty{\tilde{a_l}+\var{a_l}})
  &= \ln\Omega(\qty{\tilde{a_l}}) + \eval{\var{\ln\Omega}}_\qty{\tilde{a_l}}
     + \frac{1}{2} \eval{\var[2]{\ln\Omega}}_\qty{\tilde{a_l}} + \cdots \notag \\
  &= \ln\Omega(\qty{\tilde{a_l}}) + 0 - \frac{1}{2} \sum_l \frac{\qty(\var{a_l})^2}{\tilde{a_l}},
\end{align}
即
\begin{equation}
  \ln\frac{\Omega+\incr{\Omega}}{\Omega}
  = -\frac{1}{2} \sum_l \qty(\frac{\var{a_l}}{\tilde{a_l}})^2 \tilde{a_l}
  \implies \frac{\Omega+\incr{\Omega}}{\Omega}
           = \exp[-\frac{1}{2} \sum_l \qty(\frac{\var{a_l}}{\tilde{a_l}})^2 \tilde{a_l}].
\end{equation}
在热力学极限下，$\sum_l a_l=N \sim 10^{23}$，即使 $\var{a_l}$ 很小（如 $10^{-5}$），也有
\begin{equation}
  \frac{\Omega+\incr{\Omega}}{\Omega}
  \sim \exp(-\frac{1}{2}\times\num{e-10}\times\num{e23}) \lll 1.
\end{equation}
这说明 $\Omega$ 具有尖锐成锋的特性，类似数学中的 Dirac-$\delta$ 函数。

\subsection{经典统计中 Boltzmann 分布的表达式}

之前的讨论建立在能级分立的量子情形上，现在将其推广到经典情形。我们需要在维度为 $r$ 的 μ 空间中划分
出等大的\kwd{相格}，其体积为
\begin{equation}
  \qty\big(\var{q_1}\var{q_2}\cdots\var{q_r}) \, \qty\big(\var{p_1}\var{p_2}\cdots\var{p_r})
  = (\var{q_1}\var{p_1}) \, (\var{q_2}\var{p_2}) \, \cdots (\var{q_r}\var{p_r}) = h_0^r.
\end{equation}
式中的 $h_0=\incr{q_i}\incr{p_i}$ 为相格的尺度。当相格体积很小时，同一相格中不同代表点所代表的粒子，
其运动状态的差别可以忽略不计，即所有代表点都具有近似相同的广义坐标 $q_i$ 和广义动量 $p_i$。显然，相
格的尺度取得越小，对运动的刻画就越精确。但是，量子力学为相格的尺度给出了下限，为 \kwd{Planck 常数}
\begin{equation}
  h = \SI{6.626070040(81)e-34}{\joule\second}.
\end{equation}
这种近似通常被称为 μ 空间的\kwd{粗粒近似}。

再将 μ 空间中划分为许多体积元 $\incr{\omega_l}$。按照粗粒近似的观点，我们认为体积元
$\incr{\omega_l}$ 中有大量的代表点，它们均处在同一能级 $\varepsilon_l$ 上。能级的简并度 $\omega_l$
与 $\incr{\omega_l}$ 的体积成正比，取为
\begin{equation}
  \omega_l = \frac{\incr{\omega_l}}{h_0^r}.
\end{equation}
此时，类比式~\eqref{eq:number-of-states-in-boltzmann-dist} 和 \eqref{eq:maxwell-boltzmann-dist}，我
们即可写出经典情形下的 Boltzmann 体系的微观态数目
\begin{equation}
  \Omega_\text{classical}
  = \frac{N!}{\prod_l a_l!} \prod_l \qty(\frac{\incr{\omega_l}}{h_0^r})^{a_l}
\end{equation}
以及 Maxwell--Boltzmann 分布
\begin{equation}
  a_{l,\,\text{classical}} = \frac{\incr{\omega_l}}{h_0^r} \, \ee^{-\alpha-\beta\varepsilon_l}.
\end{equation}
$a_{l,\,\text{classical}}$ 满足也约束 \eqref{eq:constraint-condition-of-dist}~式：
\begin{equation}
  \sum_l a_l = N \qc \sum_l \varepsilon_l a_l = E.
\end{equation}

\section{Bose--Einstein 分布与 Fermi--Dirac 分布}

\subsection{Bose--Einstein 分布}

在 \ref{subsec:bose-einstein-system}~小节中，我们已经得到了 Bose--Einstein 分布的量子态数目：
\begin{equation}
  \Omega_\text{BE}(\qty{a_l}) = \prod_l \frac{\qty(a_l+\omega_l-1)!}{a! \, \qty(\omega_l-1)!}.
  \tag*{\eqref{eq:number-of-states-in-bose-dist}}
\end{equation}
于是有
\begin{align}
  \ln\Omega_\text{BE}
  &=       \sum_l \qty\big[\ln(a_l+\omega_l-1)! - \ln a_l! - \ln(\omega_l-1)!] \notag
  \intertext{取 $a_l \gg 1$ 和 $\omega \gg 1$，忽略常数 1：}
  &\approx \sum_l \qty\big[\ln(a_l+\omega_l)! - \ln a_l! - \ln\omega_l!] \notag
  \intertext{利用 Stirling 公式：}
  &\approx \sum_l \qty\Big{  (a_l+\omega_l) \, \qty\big[\ln(a_l+\omega_l)-1]
                           - a_l \, \qty(\ln a_l-1) - \omega_l \, \qty(\ln\omega_l-1)} \notag \\
  &=       \sum_l \qty\big[  (a_l+\omega_l) \, \ln(a_l+\omega_l)
                           - a_l\ln a_l - \omega_l\ln\omega_l].
\end{align}
对其求变分，得
\begin{equation}
  \var{\ln\Omega_\text{BE}}
  = \sum_l \qty\big[\var{a_l}\ln(a_l+\omega_l) + \var{a_l} - \var{a_l}\ln a_l - \var{a_l}]
  = \sum_l \ln(\frac{\omega_l}{a_l}+1) \var{a_l}.
\end{equation}
根据极值点条件 $\var{\Omega_\text{BE}}=0$，并引入 Lagrange 乘子 $\alpha$、$\beta$，可有
\begin{equation}
  \var{\ln\Omega_\text{BE}} - \alpha\var{N} - \beta\var{E}
  = \sum_l \qty[\ln(\frac{\omega_l}{a_l}+1) - \alpha - \beta\varepsilon_l] \var{a_l} = 0.
\end{equation}
令 $\var{a_l}$ 的系数为零，立即得到 \kwd{Bose--Einstein 分布}
\begin{equation}
  a_l = \frac{\omega_l}{\ee^{\alpha+\beta\varepsilon_l}-1}.
\end{equation}
其中，$\alpha$、$\beta$ 需满足
\begin{equation}
  N = \sum_l a_l = \sum_l \frac{\omega_l}{\ee^{\alpha+\beta\varepsilon_l}-1} \qc
  E = \sum_l a_l \varepsilon_l = \sum_l \frac{\omega_l\varepsilon_l}%
                                        {\ee^{\alpha+\beta\varepsilon_l}-1}.
\end{equation}

\subsection{Fermi--Dirac 分布}

Fermi--Dirac 分布的推导是完全类似的。仍然从量子态数目
\begin{equation}
  \Omega_\text{FD}(\qty{a_l}) = \prod_l \frac{\omega_l!}{a_l! \, \qty(\omega_l-a_l)!}
  \tag*{\eqref{eq:number-of-states-in-fermi-dist}}
\end{equation}
出发，我们有
\begin{align}
  \ln\Omega_\text{FD}
  &=       \sum_l \qty\big[\ln\omega_l! - \ln a_l! - \ln(\omega_l-a_l)!] \notag \\
  &\approx \sum_l \qty\big[\omega_l\ln\omega_l - a_l\ln a_l
                           - (\omega_l-a_l) \, \ln(\omega_l-a_l)], \\
  \var{\ln\Omega_\text{FD}}
  &= \sum_l \ln(\frac{\omega_l}{a_l}-1) \var{a_l}.
\end{align}
根据极值点条件 $\var{\Omega_\text{FD}}=0$，并引入 Lagrange 乘子 $\alpha$、$\beta$，同理可有
\begin{equation}
  \var{\ln\Omega_\text{FD}} - \alpha\var{N} - \beta\var{E}
  = \sum_l \qty[\ln(\frac{\omega_l}{a_l}-1) - \alpha - \beta\varepsilon_l] \var{a_l} = 0.
\end{equation}
令 $\var{a_l}$ 的系数为零，得到 \kwd{Fermi--Dirac 分布}
\begin{equation}
  a_l = \frac{\omega_l}{\ee^{\alpha+\beta\varepsilon_l}+1}.
\end{equation}
其中，$\alpha$、$\beta$ 需满足
\begin{equation}
  N = \sum_l a_l = \sum_l \frac{\omega_l}{\ee^{\alpha+\beta\varepsilon_l}+1} \qc
  E = \sum_l a_l \varepsilon_l = \sum_l \frac{\omega_l\varepsilon_l}%
                                        {\ee^{\alpha+\beta\varepsilon_l}+1}.
\end{equation}
与 Bose--Einstein 分布相比，只有分母上的 “$-1$” 变成了 “$+1$”，其余完全一致。

值得注意的是，在推导 Fermi--Dirac 分布时，我们也需要近似 $a_l \gg 1$。这显然是荒谬的，因为 Pauli 不
相容原理要求每个量子态上最多占据一个粒子。可见，尽管这里给出的结果是正确的，但其理论基础却并不完善。
利用系综理论，才可以比较好地解决这一问题。

\subsection{非简并条件（II）}

我们这里再把三种分布全部列出：

\begin{table}[ht]
  \centering
  \caption{三种分布}
  \begin{tabular}{ccc}
    \toprule
      Boltzmann--Maxwell 分布 & Bose--Einstein 分布 & Fermi--Dirac 分布 \\
    \midrule \addlinespace[1.2ex]
      $\displaystyle a_l = \frac{\omega_l}{\ee^{\alpha+\beta\varepsilon_l}}$   &
      $\displaystyle a_l = \frac{\omega_l}{\ee^{\alpha+\beta\varepsilon_l}-1}$ &
      $\displaystyle a_l = \frac{\omega_l}{\ee^{\alpha+\beta\varepsilon_l}+1}$ \\[1.5ex]
    \bottomrule
  \end{tabular}
\end{table}

可以发现，当 $\ee^{\alpha} \gg 1$ 时，Bose--Einstein 分布 / Fermi--Dirac 分布中分母上的 $\pm 1$ 可以
忽略，即它们均趋同于 Boltzmann--Maxwell 分布。稍加变形可知，$\ee^{\alpha} \gg 1$ 时有
\begin{equation}
  \frac{a_l}{\omega_l} = \frac{1}{\ee^{\alpha+\beta\varepsilon_l}+\eta} \ll 1.
\end{equation}
式中的 $\eta$ 取 $0, \, \pm 1$ 正好对应三种分布。这正是我们在
\ref{subsec:non-degenerate-condition-i}~小节中提到的\kwd{非简并条件}。
